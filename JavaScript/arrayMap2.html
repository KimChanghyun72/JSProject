<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>javascript/arrayMap2.html</title>
</head>
<body>
    <select name="gender" id="gender" onchange="onChangeFunc()">
        <option value="Male">Male</option>
        <option value="Female">Female</option>
    </select>
        <p id="show"></p>
    <script>
        var jsonData=[{"id":1,"first_name":"Daisey","last_name":"Ragsdale","email":"dragsdale0@loc.gov","gender":"Female"},
        {"id":2,"first_name":"Teressa","last_name":"Mathy","email":"tmathy1@elegantthemes.com","gender":"Female"},
        {"id":3,"first_name":"Courtnay","last_name":"Thurber","email":"cthurber2@feedburner.com","gender":"Male"},
        {"id":4,"first_name":"Kit","last_name":"Jeannaud","email":"kjeannaud3@bizjournals.com","gender":"Female"},
        {"id":5,"first_name":"Kalindi","last_name":"Lowth","email":"klowth4@epa.gov","gender":"Female"},
        {"id":6,"first_name":"Emmanuel","last_name":"Speeding","email":"espeeding5@twitter.com","gender":"Male"},
        {"id":7,"first_name":"Doy","last_name":"Lukacs","email":"dlukacs6@eepurl.com","gender":"Male"},
        {"id":8,"first_name":"Germain","last_name":"Nutley","email":"gnutley7@myspace.com","gender":"Male"},
        {"id":9,"first_name":"Vannie","last_name":"Summerside","email":"vsummerside8@cmu.edu","gender":"Female"},
        {"id":10,"first_name":"Gar","last_name":"Balchin","email":"gbalchin9@shareasale.com","gender":"Male"},
        {"id":11,"first_name":"Darrick","last_name":"Whitsey","email":"dwhitseya@hhs.gov","gender":"Male"},
        {"id":12,"first_name":"Augustus","last_name":"Audley","email":"aaudleyb@apache.org","gender":"Male"},
        {"id":13,"first_name":"Alfredo","last_name":"Brinded","email":"abrindedc@tmall.com","gender":"Male"},
        {"id":14,"first_name":"Fin","last_name":"Henker","email":"fhenkerd@hostgator.com","gender":"Male"},
        {"id":15,"first_name":"Gertrud","last_name":"Rozzell","email":"grozzelle@huffingtonpost.com","gender":"Female"}];
        console.log(jsonData);
        
        function onChangeFunc(){

        var newAry = jsonData.map(function(o,i,a){
            o.first_name = o.first_name.toUpperCase();
            return o;
        }); //full-name이라는 field 새로 만들어서 추가.

        var filterAry = newAry.filter(function(o,i){
            return o.gender == document.getElementById("gender").value;
        }); //gender 값이 태그 선택한것과 같은 값인 것만 배열에 담음.

        console.log(filterAry);
        var $show = document.getElementById("show");

        //$show.innerHTML = "";
        var cnt = $show.children.length;
        for(var i=0; i<cnt; i++){
            $show.removeChild($show.firstChild);    //firstChild = 태그의 첫 번째 요소.
        }   //innerHTML은 분석하는 과정이 추가로 있기 때문에 속도가 느리다.
            //기존 화면 요소 지워주기.
            //하위자식으로 등록

        filterAry.forEach(function(a){
            var $text = document.createTextNode(a.first_name + ", " + a.gender);
            var $li = document.createElement("li");
            $li.appendChild($text);
            $show.appendChild($li);
        });

    }
    </script>
</body>
</html>